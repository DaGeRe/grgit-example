import org.ajoberstar.grgit.Grgit

plugins {
    id 'java-library'
    id "org.ajoberstar.grgit" version "4.1.0"
}

task provideTestData {
    group = 'data'
    doLast {
        def dataFolder = 'data/test'

        if (!project.file(dataFolder + '/.git').exists()) {
            Grgit.clone(dir: project.file(dataFolder), uri: 'git@github.com:DaGeRe/private-demo-repo.git')
        }
        def grgit = Grgit.open(dir: project.file(dataFolder))
        System.out.println(project.file(dataFolder))
        grgit.fetch()
    }
}

repositories {
    mavenCentral()
}

dependencies {
    testImplementation 'org.junit.jupiter:junit-jupiter-api:5.8.2'
    testRuntimeOnly 'org.junit.jupiter:junit-jupiter-engine:5.8.2'
}

test {
    useJUnitPlatform()
}

tasks.test.dependsOn("provideTestData")
